javascript:function main(){let e=getStructuredHackerNewsList(),t=getBottomOfHackerNewsList();rankHackerNewsPosts(e),replaceDomWithSortedHackerNewsList(e,t)}function getSiteWeightingCoefficient(e){switch(e){case"github.com":return 60;case"newyorker.com":return 50;default:return 0}}function getStructuredHackerNewsList(){let e="span.titleline > a";return[...document.querySelectorAll("#hnmain > tbody > tr:nth-child(3) > td > table > tbody > tr")].filter(function(e){return e.classList.contains("athing")}).map(function(t,n){let r=t.nextSibling.querySelectorAll(".score")[0],i=0;void 0!==r&&(i=r.innerHTML.match("^([0-9]*)( )(points)$")[1]);let l=.8*(i=parseInt(i)),o=t.nextSibling.querySelectorAll("a"),u=o[o.length-1],c=0,a=u.innerHTML.match("^([0-9]*)(&nbsp;)(comments)$");null!==a&&(c=a[1]);let s=1.2*(c=parseInt(c)),m="";null!==t.querySelector(".sitestr")&&(m=t.querySelector(".sitestr").innerHTML);let g=getSiteWeightingCoefficient(m),d="";return null!==t.querySelector(e)&&(d=t.querySelector(e).innerHTML),{titleDom:t,title:d,metaDataDom:t.nextSibling,blankLineDom:t.nextSibling.nextSibling,site:m,score:i,numberOfComments:c,siteWeightingCoefficient:g,sum:i+c,weightedSum:l+s+g}}).sort(function(e,t){return e.sum-t.sum})}function getBottomOfHackerNewsList(){let e=document.querySelector(".morespace"),t=e.nextSibling;return[e,t]}function replaceDomWithSortedHackerNewsList(e,t){let n=document.querySelector("#hnmain > tbody > tr:nth-child(3) > td > table > tbody");n.innerHTML="",e.reverse().map(function(e){n.appendChild(e.titleDom),n.appendChild(e.metaDataDom),n.appendChild(e.blankLineDom)}),t.map(function(e){n.appendChild(e)})}function isOdd(e){return e%2==1}function getAverage(e){return e.reduce(function(e,t){return e+t.sum},0)/e.length}function getVariance(e,t){return e.reduce(function(e,n){return e+Math.pow(n.sum-t,2)},0)}function getStandardDevilation(e,t){return Math.sqrt(t/e.length)}function getMedian(e){let t=e.length;if(isOdd(t))result=e[Math.ceil(t/2)-1].sum;else{let n=t/2-1;result=(e[n].sum+e[n+1].sum)/2}return result}function getQuartiles(e){let t=e.length,n=e.slice(),r;return{lower:getMedian(n.splice(0,Math.round(t/2))),median:getMedian(e),upper:getMedian(n)}}function rankHackerNewsPosts(e){let t=200,n=getQuartiles(e),r=getAverage(e),i=getVariance(e,r);getStandardDevilation(e,i);let l=n.upper-t;return l<0&&Math.abs(l/t)>.25&&(t*=.68),e.map(function(e){let n="#f70441",r="#28a745",i=".rank",l=".titleline>a";e.weightedSum>400?(e.titleDom.querySelector(i).style.color=n,e.titleDom.querySelector(l).style.color=n):e.weightedSum>t&&(e.titleDom.querySelector(i).style.color=r,e.titleDom.querySelector(l).style.color=r)})}main();
