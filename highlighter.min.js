javascript:function main(){let e=getStructuredHackerNewsList(),t=getBottomOfHackerNewsList();rankHackerNewsPosts(e),replaceDomWithSortedHackerNewsList(e,t)}function getSiteWeightingCoefficient(e){switch(e){case"github.com":return 60;case"newyorker.com":return 50;default:return 0}}function getStructuredHackerNewsList(){return[...document.querySelectorAll(".itemlist tbody tr")].filter(function(e){return e.classList.contains("athing")}).map(function(e,t){let n=e.nextSibling.querySelectorAll(".score")[0],r=0;void 0!==n&&(r=n.innerHTML.match("^([0-9]*)( )(points)$")[1]);let i=.8*(r=parseInt(r)),l=e.nextSibling.querySelectorAll("a"),o=0,u=l[l.length-1].innerHTML.match("^([0-9]*)(&nbsp;)(comments)$");null!==u&&(o=u[1]);let a=1.2*(o=parseInt(o)),c="";null!==e.querySelector(".sitestr")&&(c=e.querySelector(".sitestr").innerHTML);let s=getSiteWeightingCoefficient(c);return{titleDom:e,title:e.innerText,metaDataDom:e.nextSibling,blankLineDom:e.nextSibling.nextSibling,site:c,score:r,numberOfComments:o,siteWeightingCoefficient:s,sum:r+o,weightedSum:i+a+s}}).sort(function(e,t){return e.sum-t.sum})}function getBottomOfHackerNewsList(){let e=document.querySelector(".morespace");return[e,e.nextSibling]}function replaceDomWithSortedHackerNewsList(e,t){let n=document.querySelector(".itemlist tbody");n.innerHTML="",e.reverse().map(function(e){n.appendChild(e.titleDom),n.appendChild(e.metaDataDom),n.appendChild(e.blankLineDom)}),t.map(function(e){n.appendChild(e)})}function isOdd(e){return e%2==1}function getAverage(e){return e.reduce(function(e,t){return e+t.sum},0)/e.length}function getVariance(e,t){return e.reduce(function(e,n){let r=n.sum-t;return e+Math.pow(r,2)},0)}function getStandardDevilation(e,t){return Math.sqrt(t/e.length)}function getMedian(e){let t=e.length;if(isOdd(t)){let n=Math.ceil(t/2)-1;result=e[n].sum}else{let n=t/2-1,r=n+1;result=(e[n].sum+e[r].sum)/2}return result}function getQuartiles(e){let t=e.length,n=e.slice(),r=Math.round(t/2),i=n;return{lower:getMedian(n.splice(0,r)),median:getMedian(e),upper:getMedian(i)}}function rankHackerNewsPosts(e){let t=200,n=getQuartiles(e),r=(getStandardDevilation(e,getVariance(e,getAverage(e))),n.upper-t);return r<0&&Math.abs(r/t)>.25&&(t*=.68),e.map(function(e){e.weightedSum>400?(e.titleDom.querySelector(".rank").style.color="#f70441",e.titleDom.querySelector(".titleline>a").style.color="#f70441"):e.weightedSum>t&&(e.titleDom.querySelector(".rank").style.color="#28a745",e.titleDom.querySelector(".titleline>a").style.color="#28a745")})}main();
